<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>AR Filter Simulator</title>
  <style>
    body {
      background: #000;
      color: #fff;
      font-family: Arial, sans-serif;
      text-align: center;
      margin: 0;
      padding: 0;
    }
    #uploader {
      margin-top: 50px;
    }
    #phone {
      display: none;
      margin: 20px auto;
      width: 320px;
      height: 500px;
      border-radius: 30px;
      border: 6px solid hotpink;
      position: relative;
      background: #111;
      overflow: hidden;
    }
    #selfie {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }
    #filterOverlay {
      position: absolute;
      inset: 0;
      pointer-events: none;
      display: none;
    }
    #timer {
      position: absolute;
      top: 10px;
      left: 10px;
      background: rgba(0,0,0,0.6);
      padding: 5px 10px;
      border-radius: 8px;
      font-weight: bold;
    }
    /* === Playful overlays === */
    .playful {
      background-repeat: no-repeat;
      background-position: center;
      background-size: contain;
    }
    /* === Realistic beauty effect === */
    .realistic {
      backdrop-filter: brightness(1.1) contrast(1.1) saturate(1.05);
      background: radial-gradient(circle at center,
        rgba(255,255,255,0.05) 0%,
        rgba(0,0,0,0.2) 80%);
    }
  </style>
</head>
<body>

  <div id="uploader">
    <h2>Take/Upload a Selfie</h2>
    <input type="file" id="selfieInput" accept="image/*">
    <button id="startBtn" disabled>Start Exposure</button>
  </div>

  <div id="phone">
    <img id="selfie" alt="Selfie">
    <div id="filterOverlay"></div>
    <div id="timer">01:00</div>
  </div>

  <script>
    const selfieInput = document.getElementById("selfieInput");
    const selfieImg = document.getElementById("selfie");
    const startBtn = document.getElementById("startBtn");
    const uploader = document.getElementById("uploader");
    const phoneEl = document.getElementById("phone");
    const overlay = document.getElementById("filterOverlay");
    const timerEl = document.getElementById("timer");

    // --- Filters ---
    const playfulFilters = [
      "filters/dog-ears.png",
      "filters/rainbow.png",
      "filters/glasses.png",
      "filters/crown.png"
    ];

    // --- URL parameter: ?filter=playful or ?filter=realistic ---
    const params = new URLSearchParams(window.location.search);
    const filterType = params.get("filter") || "playful";

    // Enable Start after file chosen
    selfieInput.addEventListener("change", () => {
      const file = selfieInput.files[0];
      if (!file) return;

      const reader = new FileReader();
      reader.onload = e => {
        selfieImg.src = e.target.result;
        startBtn.disabled = false;
      };
      reader.readAsDataURL(file);
    });

    // Timer
    function startTimer() {
      let remaining = 60;
      timerEl.textContent = "01:00";
      const timer = setInterval(() => {
        remaining--;
        let mins = String(Math.floor(remaining / 60)).padStart(2,"0");
        let secs = String(remaining % 60).padStart(2,"0");
        timerEl.textContent = `${mins}:${secs}`;
        if (remaining <= 0) clearInterval(timer);
      }, 1000);
    }

    // Apply filters
    function applyFilter(type) {
      if (type === "playful") {
        const random = playfulFilters[Math.floor(Math.random() * playfulFilters.length)];
        overlay.style.backgroundImage = `url('${random}')`;
        overlay.className = "playful";
        overlay.style.display = "block";
      } else {
        overlay.className = "realistic";
        overlay.style.display = "block";
      }
    }

    // Start experiment
    startBtn.addEventListener("click", () => {
      uploader.style.display = "none";
      phoneEl.style.display = "block";
      applyFilter(filterType);
      startTimer();
    });
  </script>
</body>
</html>
